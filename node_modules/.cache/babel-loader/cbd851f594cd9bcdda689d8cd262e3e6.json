{"ast":null,"code":"var _jsxFileName = \"D:\\\\Hilo\\\\hilocare\\\\src\\\\app\\\\components\\\\Login\\\\Login.js\",\n    _s = $RefreshSig$();\n\nimport classes from './Login.module.css';\nimport React, { useState, useRef, useEffect, useContext } from 'react';\nimport classes2 from '../../App.module.css';\nimport AuthContext from '../context/auth_context';\nimport { useHistory } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Login = props => {\n  _s();\n\n  const history = useHistory();\n  const authen = useContext(AuthContext);\n  const userNameInput = useRef();\n  const userPasswordInput = useRef();\n  const [isLogin, setIsLogin] = useState(true);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const switchAuthModeHandler = () => {\n    setIsLogin(prevState => !prevState);\n  };\n\n  const registerInfo = event => {\n    event.preventDefault();\n    const username = userNameInput.current.value;\n    const password = userPasswordInput.current.value;\n    setIsLoading(true);\n\n    if (isLogin) {\n      fetch('https://uathilocare.hilo.com.vn/api/Authentication/getToken', {\n        method: 'POST',\n        body: JSON.stringify({\n          userName: username,\n          userPassword: password,\n          taxCode: \"string\",\n          userType: 0\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          'Language': 'vn'\n        }\n      }).then(res => {\n        setIsLoading(false);\n\n        if (res.ok) {\n          return res.json();\n        } else {\n          return res.json().then(data => {\n            let errorMessage = data.message;\n            throw new Error(errorMessage);\n          });\n        }\n      }).then(data => {\n        if (data.code == \"200\") {\n          const expirationTime = new Date(new Date().getTime() + 3600 * 1000);\n          authen.login(data.data.token, expirationTime.toISOString());\n          history.replace('/');\n        } else {\n          alert(data.message);\n        } //history.replace('/');\n\n      }).catch(err => {\n        alert(err.message);\n      });\n    } else {\n      fetch('https://uathilocare.hilo.com.vn/api/Authentication/register', {\n        method: 'POST',\n        body: JSON.stringify({\n          userName: username,\n          userPassword: password\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          'Language': 'vn'\n        }\n      }).then(res => {\n        setIsLoading(false);\n\n        if (res.ok) {\n          return res.json();\n        } else {\n          return res.json().then(data => {\n            let errorMessage = data.message;\n            throw new Error(errorMessage);\n          });\n        }\n      }).then(data => {\n        if (data.code == \"200\") {\n          const expirationTime = new Date(new Date().getTime() + 3600 * 1000);\n          authen.login(data.data.token, expirationTime.toISOString());\n          history.replace('/');\n        } else {\n          alert(data.message);\n        }\n      }).catch(err => {\n        alert(err.message);\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.auth,\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: registerInfo,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.control,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"text\",\n          children: \"T\\xEAn \\u0111\\u0103ng nh\\u1EADp\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"text\",\n          required: true,\n          ref: userNameInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.control,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"password\",\n          children: \"M\\u1EADt kh\\u1EA9u\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          id: \"password\",\n          required: true,\n          ref: userPasswordInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.actions,\n        children: [!isLoading && /*#__PURE__*/_jsxDEV(\"button\", {\n          children: isLogin ? 'Đăng nhập' : 'Tạo tài khoản'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 29\n        }, this), isLoading && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u0111ang t\\u1EA3i\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: classes.toggle,\n          onClick: switchAuthModeHandler,\n          children: isLogin ? 'Tạo tài khoản mới' : 'Đăng nhập với tài khoản đã có'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Login, \"BBC9tID+TUpokvXkJkc0/0R/22g=\", false, function () {\n  return [useHistory];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["D:/Hilo/hilocare/src/app/components/Login/Login.js"],"names":["classes","React","useState","useRef","useEffect","useContext","classes2","AuthContext","useHistory","Login","props","history","authen","userNameInput","userPasswordInput","isLogin","setIsLogin","isLoading","setIsLoading","switchAuthModeHandler","prevState","registerInfo","event","preventDefault","username","current","value","password","fetch","method","body","JSON","stringify","userName","userPassword","taxCode","userType","headers","then","res","ok","json","data","errorMessage","message","Error","code","expirationTime","Date","getTime","login","token","toISOString","replace","alert","catch","err","auth","control","actions","toggle"],"mappings":"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","sourcesContent":["import classes from './Login.module.css';\r\nimport React, { useState, useRef, useEffect, useContext} from 'react';\r\nimport classes2 from '../../App.module.css';\r\nimport AuthContext from '../context/auth_context';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nconst Login = (props) => {\r\n\r\n\r\n    const history = useHistory();\r\n\r\n    const authen = useContext(AuthContext);\r\n    const userNameInput = useRef();\r\n    const userPasswordInput = useRef();\r\n    const [isLogin, setIsLogin] = useState(true);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const switchAuthModeHandler = () => {\r\n      setIsLogin((prevState) => !prevState);\r\n    };\r\n\r\n    const registerInfo = (event) => {\r\n      event.preventDefault();\r\n      const username = userNameInput.current.value;\r\n      const password = userPasswordInput.current.value;\r\n      setIsLoading(true);\r\n      if(isLogin) {\r\n        fetch('https://uathilocare.hilo.com.vn/api/Authentication/getToken',\r\n        {\r\n          method: 'POST',\r\n          body: JSON.stringify({\r\n            userName: username,\r\n            userPassword: password,\r\n            taxCode: \"string\",\r\n            userType: 0\r\n          }),\r\n          headers :{\r\n            'Content-Type': 'application/json',\r\n            'Language' : 'vn'\r\n          }\r\n        }).then((res) =>{\r\n          setIsLoading(false);\r\n          if(res.ok) {\r\n            return res.json()\r\n          } else {\r\n            return res.json().then((data)=>{\r\n              let errorMessage = data.message;\r\n              throw new Error(errorMessage)\r\n            }); \r\n          }\r\n        }).then((data) =>{\r\n          if(data.code == \"200\") {\r\n            const expirationTime = new Date((new Date().getTime() + (3600 * 1000)));\r\n            authen.login(data.data.token, expirationTime.toISOString());\r\n            history.replace('/');\r\n          }\r\n          else{\r\n            alert(data.message);\r\n          }\r\n          //history.replace('/');\r\n        }).catch((err) =>{\r\n          alert(err.message);\r\n        })\r\n      } \r\n      else {\r\n        fetch('https://uathilocare.hilo.com.vn/api/Authentication/register',\r\n        {\r\n          method: 'POST',\r\n          body: JSON.stringify({\r\n            userName: username,\r\n            userPassword: password,\r\n          }),\r\n          headers :{\r\n            'Content-Type': 'application/json',\r\n            'Language' : 'vn'\r\n          }\r\n        }).then((res) =>{\r\n          setIsLoading(false);\r\n          if(res.ok) {\r\n            return res.json()\r\n          } else {\r\n            return res.json().then((data)=>{\r\n              let errorMessage = data.message;\r\n              throw new Error(errorMessage)\r\n            }); \r\n          }\r\n        }).then((data) =>{\r\n          if(data.code == \"200\") {\r\n            const expirationTime = new Date((new Date().getTime() + (3600 * 1000)));\r\n            authen.login(data.data.token, expirationTime.toISOString());\r\n            history.replace('/');\r\n          }\r\n          else{\r\n            alert(data.message);\r\n          }\r\n        }).catch((err) =>{\r\n          alert(err.message);\r\n        })\r\n      }\r\n    }\r\n  \r\n      return (\r\n        <div className={classes.auth}>\r\n          <form onSubmit={registerInfo}>\r\n            <div className={classes.control}>\r\n              <label htmlFor='text'>Tên đăng nhập</label>\r\n              <input type='text' id='text' required ref={userNameInput}/>\r\n            </div>\r\n            <div className={classes.control}>\r\n              <label htmlFor='password'>Mật khẩu</label>\r\n              <input type='password' id='password' required ref={userPasswordInput}/>\r\n            </div>\r\n            <div className={classes.actions}>\r\n              {!isLoading &&<button>{isLogin ? 'Đăng nhập' : 'Tạo tài khoản'}</button>}\r\n              {isLoading && <p>đang tải</p>}\r\n              <button\r\n                type='button'\r\n                className={classes.toggle}\r\n                onClick={switchAuthModeHandler}\r\n              >\r\n                {isLogin ? 'Tạo tài khoản mới' : 'Đăng nhập với tài khoản đã có'}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n    );\r\n  }\r\n  \r\n\r\n\r\nexport default Login;"]},"metadata":{},"sourceType":"module"}